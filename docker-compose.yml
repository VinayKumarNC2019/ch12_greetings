# Docker Compose file reference: https://docs.docker.com/compose/compose-file/
version: '3.7'

# todo: 
# * DRY-out DEPLOY_ENV

configs:
  standard_config:
    file: ./api/config/config.common.yml
  env_specific_config:
    file: ./api/config/config.${DEPLOY_ENV:-prod}.yml

services:

  api:
      image: ${IMAGE_REPOSITORY:-dockerinaction/ch12_greetings}:api
      ports:
        - '8080:8080'
        - '8443:8443'
      user: '1000'
      configs:
        - standard_config
        - env_specific_config
      secrets: []
      environment:
        DEPLOY_ENV: ${DEPLOY_ENV:-prod}
        # uncomment to print debugging statements.  note: will TLS certificate info to stdout/logs, including private key
        #DEBUG: 'true'
